# ğŸš€ CodeQuest ğŸš€

Â¡Bienvenido a CodeQuest! Una plataforma sencilla y escalable diseÃ±ada para ayudar a programadores junior a practicar y mejorar sus habilidades resolviendo retos de cÃ³digo en JavaScript y Python.

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
<!-- Add other badges if you have CI/CD, deployment status, etc. -->
<!-- Example: [![Netlify Status](https://api.netlify.com/api/v1/badges/YOUR_BADGE_ID/deploy-status)](https://app.netlify.com/sites/YOUR_SITE_NAME/deploys) -->

![CodeQuest Screenshot](public/screenshot.png) <!-- Optional: Add a screenshot -->

## ğŸ“œ Tabla de Contenidos

*   [âœ¨ CaracterÃ­sticas](#-caracterÃ­sticas)
*   [ğŸ› ï¸ TecnologÃ­as](#-tecnologÃ­as)
*   [âš™ï¸ InstalaciÃ³n y ConfiguraciÃ³n](#-instalaciÃ³n-y-configuraciÃ³n)
    *   [Prerrequisitos](#prerrequisitos)
    *   [Clonar Repositorio](#clonar-repositorio)
    *   [Instalar Dependencias](#instalar-dependencias)
    *   [ConfiguraciÃ³n de Supabase](#configuraciÃ³n-de-supabase)
    *   [Variables de Entorno](#variables-de-entorno)
*   [ğŸš€ Uso](#-uso)
*   [ğŸ“‚ Estructura del Proyecto](#-estructura-del-proyecto)
*   [ğŸ¤ Contribuir](#-contribuir)
*   [ğŸ“„ Licencia](#-licencia)

## âœ¨ CaracterÃ­sticas

*   **ExploraciÃ³n de Retos:** Busca y filtra retos por tÃ­tulo, lenguaje (JavaScript/Python), nivel de dificultad y etiquetas.
*   **Editor de CÃ³digo Integrado:** Escribe y prueba tu cÃ³digo directamente en el navegador con resaltado de sintaxis (`react-simple-code-editor` + Prism.js).
*   **EjecuciÃ³n y ValidaciÃ³n:** Ejecuta tu cÃ³digo contra casos de prueba predefinidos y obtÃ©n feedback inmediato.
*   **Historial Personal:** Revisa tus envÃ­os anteriores, el cÃ³digo y los resultados obtenidos.
*   **Perfil de Usuario:** Visualiza tu progreso, estadÃ­sticas y retos completados.
*   **Ranking Global:** Compara tu puntuaciÃ³n con otros usuarios en la tabla de clasificaciÃ³n.
*   **Panel de AdministraciÃ³n:** (Acceso restringido) Permite crear, editar y eliminar retos.
*   **AutenticaciÃ³n Segura:** Manejo de usuarios con Supabase Auth.
*   **Tema Claro/Oscuro:** AdaptaciÃ³n automÃ¡tica al tema del sistema operativo/navegador.

## ğŸ› ï¸ TecnologÃ­as

*   **Framework:** [Next.js](https://nextjs.org/) (App Router)
*   **Lenguaje:** [TypeScript](https://www.typescriptlang.org/)
*   **Backend & Base de Datos:** [Supabase](https://supabase.com/) (Auth, Postgres DB, Realtime)
*   **Estilos:** [Tailwind CSS](https://tailwindcss.com/)
*   **Editor de CÃ³digo:** [react-simple-code-editor](https://github.com/satya164/react-simple-code-editor) + [Prism.js](https://prismjs.com/)
*   **Gestor de Paquetes:** npm / pnpm

## âš™ï¸ InstalaciÃ³n y ConfiguraciÃ³n

### Prerrequisitos

*   [Node.js](https://nodejs.org/) (v18 o superior recomendado)
*   [npm](https://www.npmjs.com/) o [pnpm](https://pnpm.io/)
*   Una cuenta gratuita en [Supabase](https://supabase.com/)

### Clonar Repositorio

```bash
git clone https://github.com/tu-usuario/codequest.git # Reemplaza con tu URL
cd codequest
```

### Instalar Dependencias

Elige tu gestor de paquetes preferido:

```bash
npm install
# o
pnpm install
```

### ConfiguraciÃ³n de Supabase

1.  **Crea un Proyecto en Supabase:** Ve a [supabase.com](https://supabase.com/) y crea un nuevo proyecto.
2.  **Esquema de Base de Datos:**
    *   Ve al "SQL Editor" en tu proyecto Supabase.
    *   Crea las tablas necesarias. Puedes usar el siguiente SQL como punto de partida (ajÃºstalo segÃºn tus necesidades):

    ```sql
    -- Tabla para almacenar los retos
    CREATE TABLE challenges (
      id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      created_at timestamp with time zone DEFAULT timezone('utc'::text, now()) NOT NULL,
      titulo text NOT NULL,
      descripcion text,
      lenguaje text NOT NULL CHECK (lenguaje IN ('javascript', 'python')),
      nivel text NOT NULL CHECK (nivel IN ('FÃ¡cil', 'Medio', 'DifÃ­cil')),
      etiquetas text[],
      codigo_base text,
      test_cases jsonb -- Almacena los casos de prueba como JSON [{ "input": [...], "output": ... }, ...]
    );

    -- Tabla para almacenar los envÃ­os de los usuarios
    CREATE TABLE submissions (
      id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      created_at timestamp with time zone DEFAULT timezone('utc'::text, now()) NOT NULL,
      user_id uuid REFERENCES auth.users(id) ON DELETE CASCADE NOT NULL,
      challenge_id bigint REFERENCES challenges(id) ON DELETE CASCADE NOT NULL,
      codigo text,
      resultado jsonb -- Almacena los resultados como JSON ["Caso 1: âœ… Correcto", "Caso 2: âŒ Error..."]
    );

    -- Tabla para perfiles pÃºblicos (extendiendo auth.users)
    CREATE TABLE public_user_profiles (
      id uuid PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE NOT NULL,
      email text, -- Puedes almacenar el email aquÃ­ si necesitas mostrarlo pÃºblicamente
      is_admin boolean DEFAULT false NOT NULL -- Columna para marcar administradores
      -- AÃ±ade otros campos pÃºblicos si es necesario (ej. username, avatar_url)
    );

    -- FunciÃ³n para sincronizar perfiles al crear usuarios en auth.users
    CREATE OR REPLACE FUNCTION public.handle_new_user()
    RETURNS trigger
    LANGUAGE plpgsql
    SECURITY DEFINER SET search_path = public
    AS $$
    BEGIN
      INSERT INTO public.public_user_profiles (id, email)
      VALUES (new.id, new.email);
      RETURN new;
    END;
    $$;

    -- Trigger para ejecutar la funciÃ³n al crear un usuario
    CREATE TRIGGER on_auth_user_created
      AFTER INSERT ON auth.users
      FOR EACH ROW EXECUTE PROCEDURE public.handle_new_user();

    -- Habilitar lectura pÃºblica para retos
    ALTER TABLE challenges ENABLE ROW LEVEL SECURITY;
    CREATE POLICY "Allow public read access to challenges" ON challenges
      FOR SELECT USING (true);

    -- Habilitar lectura/escritura para envÃ­os (solo el propio usuario)
    ALTER TABLE submissions ENABLE ROW LEVEL SECURITY;
    CREATE POLICY "Allow individual read access to submissions" ON submissions
      FOR SELECT USING (auth.uid() = user_id);
    CREATE POLICY "Allow individual insert access to submissions" ON submissions
      FOR INSERT WITH CHECK (auth.uid() = user_id);

    -- Habilitar lectura pÃºblica para perfiles
    ALTER TABLE public_user_profiles ENABLE ROW LEVEL SECURITY;
    CREATE POLICY "Allow public read access to profiles" ON public_user_profiles
      FOR SELECT USING (true);

    -- PolÃ­ticas de Admin (Ejemplo: Solo admins pueden crear/modificar/eliminar retos)
    CREATE POLICY "Allow admin full access to challenges" ON challenges
      FOR ALL USING (public.is_user_admin(auth.uid())) WITH CHECK (public.is_user_admin(auth.uid()));

    -- PolÃ­ticas de Admin (Ejemplo: Solo admins pueden leer todas las submissions)
    CREATE POLICY "Allow admin read access to all submissions" ON submissions
      FOR SELECT USING (public.is_user_admin(auth.uid()));

    -- PolÃ­ticas de Admin (Ejemplo: Solo admins pueden modificar perfiles - Â¡CUIDADO!)
    -- CREATE POLICY "Allow admin update access to profiles" ON public_user_profiles
    --   FOR UPDATE USING (public.is_user_admin(auth.uid())) WITH CHECK (public.is_user_admin(auth.uid()));

    -- FunciÃ³n auxiliar para verificar si un usuario es admin (requiere RLS en public_user_profiles)
    CREATE OR REPLACE FUNCTION public.is_user_admin(user_id uuid)
    RETURNS boolean
    LANGUAGE sql
    SECURITY DEFINER SET search_path = public -- Importante para que pueda leer is_admin
    AS $$
      SELECT EXISTS (
        SELECT 1
        FROM public_user_profiles p
        WHERE p.id = user_id AND p.is_admin = true
      );
    $$;

    ```

3.  **PolÃ­ticas RLS (Row Level Security):** El SQL anterior incluye polÃ­ticas bÃ¡sicas. **AsegÃºrate de entenderlas y ajustarlas a tus necesidades de seguridad.** Habilita RLS para cada tabla sensible.
4.  **Marcar Usuario como Admin:** DespuÃ©s de crear tu cuenta de usuario en la aplicaciÃ³n, ve a la tabla `public_user_profiles` en Supabase y cambia el valor de `is_admin` a `true` para tu usuario.

### Variables de Entorno

1.  **Encuentra tus Claves API:** En tu proyecto Supabase, ve a `Project Settings` > `API`.
2.  **Crea el archivo `.env.local`:** En la raÃ­z de tu proyecto `codequest`, crea un archivo llamado `.env.local`.
3.  **AÃ±ade las variables:** Copia y pega tus claves API en el archivo `.env.local`:

    ```plaintext
    # .env.local
    NEXT_PUBLIC_SUPABASE_URL=TU_PROJECT_URL_DE_SUPABASE
    NEXT_PUBLIC_SUPABASE_ANON_KEY=TU_ANON_PUBLIC_KEY_DE_SUPABASE
    ```

    *   **`NEXT_PUBLIC_SUPABASE_URL`**: La URL de tu proyecto Supabase.
    *   **`NEXT_PUBLIC_SUPABASE_ANON_KEY`**: La clave anÃ³nima (pÃºblica) de tu proyecto. **Nunca compartas la clave `service_role` en el frontend.**

    *Nota: El archivo `.env.local` ya estÃ¡ incluido en `.gitignore` por defecto en proyectos Next.js, asegurando que no subas tus claves a GitHub.*

## ğŸš€ Uso

1.  **Inicia el Servidor de Desarrollo:**

    ```bash
    npm run dev
    # o
    pnpm dev
    ```

2.  **Abre la AplicaciÃ³n:** Visita [`http://localhost:3000`](http://localhost:3000) en tu navegador.

## ğŸ“‚ Estructura del Proyecto

```
codequest/
â”œâ”€â”€ public/                 # Archivos estÃ¡ticos (imÃ¡genes, fuentes)
â”‚   â””â”€â”€ screenshot.png      # (Opcional) Captura de pantalla
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                # Rutas principales (App Router)
â”‚   â”‚   â”œâ”€â”€ (auth)/         # Rutas de autenticaciÃ³n (login, signup)
â”‚   â”‚   â”œâ”€â”€ admin/          # Rutas del panel de administraciÃ³n
â”‚   â”‚   â”‚   â”œâ”€â”€ crear/
â”‚   â”‚   â”‚   â”œâ”€â”€ retos/
â”‚   â”‚   â”‚   â””â”€â”€ submissions/
â”‚   â”‚   â”œâ”€â”€ historial/      # PÃ¡gina de historial de envÃ­os
â”‚   â”‚   â”œâ”€â”€ perfil/         # PÃ¡gina de perfil de usuario
â”‚   â”‚   â”œâ”€â”€ ranking/        # PÃ¡gina de leaderboard
â”‚   â”‚   â”œâ”€â”€ retos/          # PÃ¡gina de listado de retos
â”‚   â”‚   â”‚   â””â”€â”€ [id]/       # PÃ¡gina de detalle y resoluciÃ³n de un reto
â”‚   â”‚   â”œâ”€â”€ globals.css     # Estilos globales
â”‚   â”‚   â”œâ”€â”€ layout.tsx      # Layout principal
â”‚   â”‚   â””â”€â”€ page.tsx        # PÃ¡gina de inicio
â”‚   â”œâ”€â”€ components/         # Componentes reutilizables (Navbar, Editor, etc.)
â”‚   â”‚   â””â”€â”€ Navbar.tsx
â”‚   â”œâ”€â”€ lib/                # Utilidades y configuraciÃ³n
â”‚   â”‚   â”œâ”€â”€ hooks/          # Hooks personalizados (useAuthUser, etc.)
â”‚   â”‚   â””â”€â”€ supabase.ts     # Cliente Supabase
â”‚   â””â”€â”€ types/              # Definiciones de tipos TypeScript
â”‚       â””â”€â”€ index.ts
â”œâ”€â”€ .env.local              # Variables de entorno (Â¡NO SUBIR A GIT!)
â”œâ”€â”€ .gitignore              # Archivos ignorados por Git
â”œâ”€â”€ next.config.js          # ConfiguraciÃ³n de Next.js
â”œâ”€â”€ package.json            # Dependencias y scripts
â”œâ”€â”€ postcss.config.js       # ConfiguraciÃ³n de PostCSS (para Tailwind)
â”œâ”€â”€ tailwind.config.js      # ConfiguraciÃ³n de Tailwind CSS
â”œâ”€â”€ tsconfig.json           # ConfiguraciÃ³n de TypeScript
â””â”€â”€ README.md               # Este archivo
```

## ğŸ¤ Contribuir

Â¡Las contribuciones son bienvenidas! Si quieres mejorar CodeQuest:

1.  Haz un **Fork** del repositorio.
2.  Crea una nueva **Branch** para tu feature: `git checkout -b feature/nueva-funcionalidad`.
3.  Realiza tus cambios y haz **Commit**: `git commit -m 'AÃ±ade nueva funcionalidad'`.
4.  Haz **Push** a tu branch: `git push origin feature/nueva-funcionalidad`.
5.  Abre un **Pull Request** describiendo tus cambios.

## ğŸ“„ Licencia

Este proyecto estÃ¡ bajo la [Licencia MIT](LICENSE). <!-- AsegÃºrate de tener un archivo LICENSE si mencionas una -->
